{"version":3,"sources":["webpack:///src/views/post/edit.vue","webpack:///./src/views/post/edit.vue?086b","webpack:///./src/views/post/edit.vue"],"names":["name","components","FixedLayout","fixed_layout","FileImage2","file_image2","props","data","myPreimg","myContent","watch","computed","extends_default","Object","vuex_esm","tagId","state","write","post","clubId","content","created","this","init","mounted","methods","i","push","url","file","initData","handNext","_this","$store","commit","$actionType","set_post_data","preimg","res","params","cont","forEach","e","$http","$port","POST_DISCUSS","$qs","stringify","then","code","alert","$router","path","uploadImg","_this2","promise_default","a","resolve","reject","image_compressor_esm","quality","maxWidth","convertSize","success","result","formData","FormData","append","UPLOAD_IMG","catch","err","error","handLoadImg","item","handDeleteImage","index","post_edit","render","_vm","_h","$createElement","_c","_self","staticStyle","background","attrs","title","slot","to","icon","on","click","$event","go","_v","placeholder","type","rows","model","value","callback","$$v","expression","staticClass","_l","$index","src","load","delete","staticRenderFns","Component","__webpack_require__","normalizeComponent","edit","ssrContext","__webpack_exports__"],"mappings":"mPA4BAA,KAAA,GACAC,YACAC,YAAAC,EAAA,EACAC,WAAAC,EAAA,GAEAC,SACAC,KAPA,WAQA,OACAC,YACAC,UAAA,KAGAC,SACAC,SAAAC,OACAC,OAAAC,EAAA,EAAAD,EACAE,MAAA,SAAAC,GAAA,OAAAA,EAAAC,MAAAC,KAAAH,OACAI,OAAA,SAAAH,GAAA,OAAAA,EAAAC,MAAAC,KAAAC,QACAC,QAAA,SAAAJ,GAAA,OAAAA,EAAAC,MAAAC,KAAAT,cAIAY,QAtBA,WAuBAC,KAAAC,QAEAC,QAzBA,aA2BAC,SACAF,KADA,WAEA,QAAAG,EAAA,EAAAA,EAAA,EAAAA,IACAJ,KAAAd,SAAAmB,MACAC,IAAA,GACAC,KAAA,QAIAC,SATA,aAWAC,SAXA,WAWA,IAAAC,EAAAV,KACAA,KAAAW,OAAAC,OAAAZ,KAAAa,YAAAC,eACAhB,QAAAE,KAAAb,UACA4B,OAAAf,KAAAd,WAEA,IAKA8B,EALAC,GACApB,OAAAG,KAAAH,OACAJ,MAAAO,KAAAP,MACAyB,KAAAlB,KAAAb,UACA4B,QACAC,EAAA,GACAN,EAAAxB,SAAAiC,QAAA,SAAAC,GAAA,OAAAA,EAAAd,MAAAU,GAAAI,EAAAd,IAAA,OACAU,IAGAhB,KAAAqB,MAAAzB,KAAAI,KAAAsB,MAAAC,aAAAvB,KAAAwB,IAAAC,UAAAR,IAAAS,KAAA,SAAAV,GACA,MAAAA,EAAAW,KAMAC,MAAA,QALAlB,EAAAmB,QAAAxB,MACAyB,KAAA,kBAOAC,UApCA,SAoCAxB,GAAA,IAAAyB,EAAAhC,KACA,WAAAiC,EAAAC,EAAA,SAAAC,EAAAC,GACA,IAAAC,EAAA,EAAA9B,GACA+B,QAAA,GACAC,SAAA,IACAC,YAAA,IACAC,QAAA,SAAAC,GACA,IAAAC,EAAA,IAAAC,SACAD,EAAAE,OAAA,aACAF,EAAAE,OAAA,SAAAH,IAAAhE,MACAsD,EAAAX,MAAAzB,KAAAoC,EAAAV,MAAAwB,WAAAH,GAAAjB,KAAA,SAAAV,GACAmB,EAAAnB,KACA+B,MAAA,SAAAC,GACApB,MAAA,aAGAqB,MAdA,SAcA7B,GAEAgB,EAAAhB,SAKA8B,YA3DA,SA2DA9B,EAAAb,EAAA4C,GACAA,EAAA5C,OACAP,KAAA+B,UAAAxB,GAAAmB,KAAA,SAAAV,GACA,MAAAA,EAAAW,KACAwB,EAAA7C,IAAAU,EAAA/B,KAEA2C,MAAA,YAEAmB,MAAA,WACAnB,MAAA,aAGAwB,gBAvEA,SAuEAD,EAAAE,GACAF,EAAA5C,KAAA,GACA4C,EAAA7C,IAAA,MC5HAgD,GADiBC,OAFjB,WAA0B,IAAAC,EAAAxD,KAAayD,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,WAAqBE,aAAaC,WAAA,UAAqBH,EAAA,aAAkBI,OAAOC,MAAA,QAAcL,EAAA,eAAoBI,OAAOE,KAAA,OAAAC,GAAA,KAAuBD,KAAA,SAAaN,EAAA,aAAkBI,OAAOI,KAAA,QAAcC,IAAKC,MAAA,SAAAC,GAAyBd,EAAA3B,QAAA0C,IAAA,QAAqB,GAAAf,EAAAgB,GAAA,KAAAb,EAAA,aAAkCI,OAAOE,KAAA,SAAeG,IAAKC,MAAAb,EAAA/C,UAAqBwD,KAAA,UAAcT,EAAAgB,GAAA,YAAAhB,EAAAgB,GAAA,KAAAb,EAAA,YAAgDI,OAAOU,YAAA,UAAAC,KAAA,WAAAC,KAAA,KAAqDC,OAAQC,MAAArB,EAAA,UAAAsB,SAAA,SAAAC,GAA+CvB,EAAArE,UAAA4F,GAAkBC,WAAA,eAAyBxB,EAAAgB,GAAA,KAAAb,EAAA,WAA4BsB,YAAA,cAAwBzB,EAAA0B,GAAA1B,EAAA,kBAAAL,EAAAgC,GAA8C,OAAAxB,EAAA,eAA0BI,OAAOqB,IAAAjC,EAAA7C,KAAe8D,IAAKiB,KAAA,SAAAjE,EAAAb,GAAyB,OAAAiD,EAAAN,YAAA9B,EAAAb,EAAA4C,IAAuCmC,OAAA,SAAAhB,GAA2Bd,EAAAJ,gBAAAD,EAAAgC,WAAsC,QAEr4BI,oBCEjB,IAcAC,EAdAC,EAAA,OAcAC,CACAC,EACArC,GATA,EAXA,SAAAsC,GACAH,EAAA,QACAA,EAAA,SAaA,kBAEA,MAUAI,EAAA,QAAAL,EAAA","file":"static/js/17.c9ff68008464e86a4163.js","sourcesContent":["<!-- by 添少 -->\r\n<template>\r\n  <section style=\"background: #fff;\">\r\n    <mt-header title=\"发帖\">\r\n      <router-link to=\"/\" slot=\"left\">\r\n        <mt-button icon=\"back\" @click=\"$router.go(-1)\"></mt-button>\r\n      </router-link>\r\n      <mt-button @click=\"handNext\" slot=\"right\">发送</mt-button>\r\n    </mt-header>\r\n    <mt-field placeholder=\"请输入帖子内容\" type=\"textarea\" rows=\"4\" v-model=\"myContent\"></mt-field>\r\n    <section class=\"m-uploads\">\r\n      <template v-for=\"(item,$index) in myPreimg\">\r\n        <file-image2\r\n          :src=\"item.url\"\r\n          @load=\"(e,file)=>handLoadImg(e,file,item)\"\r\n          @delete=\"handDeleteImage(item,$index)\">\r\n        </file-image2>\r\n      </template>\r\n    </section>\r\n  </section>\r\n</template>\r\n<script>\r\n  import { mapState } from 'vuex'\r\n  import FixedLayout from '@/components/fixed-layout'\r\n  import FileImage2 from '@/components/file-image2.vue'\r\n  import ImageCompressor from 'image-compressor.js'\r\n\r\n  export default {\r\n    name: '',\r\n    components: {\r\n      FixedLayout,\r\n      FileImage2,\r\n    },\r\n    props: {},\r\n    data () {\r\n      return {\r\n        myPreimg: [],\r\n        myContent: '',\r\n      }\r\n    },\r\n    watch: {},\r\n    computed: {\r\n      ...mapState({\r\n        tagId: state => state.write.post.tagId,\r\n        clubId: state => state.write.post.clubId,\r\n        content: state => state.write.post.myContent,\r\n        // preimg: state => state.write.post.preimg,\r\n      })\r\n    },\r\n    created () {\r\n      this.init()\r\n    },\r\n    mounted () {\r\n    },\r\n    methods: {\r\n      init () {\r\n        for (let i = 0; i < 3; i++) {\r\n          this.myPreimg.push({\r\n            url: '',\r\n            file: null,\r\n          })\r\n        }\r\n      },\r\n      initData () {\r\n      },\r\n      handNext () {\r\n        this.$store.commit(this.$actionType.set_post_data, {\r\n          content: this.myContent,\r\n          preimg: this.myPreimg\r\n        })\r\n        let params = {\r\n          clubId: this.clubId,\r\n          tagId: this.tagId,\r\n          cont: this.myContent,\r\n          preimg: (() => {\r\n            let res = ''\r\n            this.myPreimg.forEach(e => e.url && (res += `${e.url}#`))\r\n            return res\r\n          })()\r\n        }\r\n        this.$http.post(this.$port.POST_DISCUSS, this.$qs.stringify(params)).then(res => {\r\n          if (res.code === 200) {\r\n            this.$router.push({\r\n              path: '/forumPage'\r\n            })\r\n            return\r\n          }\r\n          alert('发帖失败')\r\n        })\r\n      },\r\n      uploadImg (file) {\r\n        return new Promise((resolve, reject) => {\r\n          new ImageCompressor(file, {\r\n            quality: 0.8,\r\n            maxWidth: 750,\r\n            convertSize: 2000000,\r\n            success: (result) => {\r\n              const formData = new FormData()\r\n              formData.append('imgType', 1)\r\n              formData.append('upload', result, result.name)\r\n              this.$http.post(this.$port.UPLOAD_IMG, formData).then(res => {\r\n                resolve(res)\r\n              }).catch(err => {\r\n                alert('图片上传失败')\r\n              })\r\n            },\r\n            error (e) {\r\n              // console.log(e.message)\r\n              reject(e)\r\n            },\r\n          })\r\n        })\r\n      },\r\n      handLoadImg (e, file, item) {\r\n        item.file = file\r\n        this.uploadImg(file).then(res => {\r\n          if (res.code === 200) {\r\n            item.url = res.data\r\n          } else {\r\n            alert('图片上传失败')\r\n          }\r\n        }).catch(() => {\r\n          alert('图片压缩失败')\r\n        })\r\n      },\r\n      handDeleteImage (item, index) {\r\n        item.file = ''\r\n        item.url = ''\r\n      }\r\n    }\r\n  }\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n  .fixed-layout {\r\n    background-color: #fff;\r\n  }\r\n\r\n  #editor {\r\n    font-size: 16px;\r\n  }\r\n\r\n  .m-uploads {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    > section {\r\n      margin-left: 10px;\r\n      margin-bottom: 10px;\r\n      position: relative;\r\n    }\r\n  }\r\n\r\n  .m-write {\r\n    margin-bottom: 10px;\r\n  }\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/post/edit.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('section',{staticStyle:{\"background\":\"#fff\"}},[_c('mt-header',{attrs:{\"title\":\"发帖\"}},[_c('router-link',{attrs:{\"slot\":\"left\",\"to\":\"/\"},slot:\"left\"},[_c('mt-button',{attrs:{\"icon\":\"back\"},on:{\"click\":function($event){_vm.$router.go(-1)}}})],1),_vm._v(\" \"),_c('mt-button',{attrs:{\"slot\":\"right\"},on:{\"click\":_vm.handNext},slot:\"right\"},[_vm._v(\"发送\")])],1),_vm._v(\" \"),_c('mt-field',{attrs:{\"placeholder\":\"请输入帖子内容\",\"type\":\"textarea\",\"rows\":\"4\"},model:{value:(_vm.myContent),callback:function ($$v) {_vm.myContent=$$v},expression:\"myContent\"}}),_vm._v(\" \"),_c('section',{staticClass:\"m-uploads\"},[_vm._l((_vm.myPreimg),function(item,$index){return [_c('file-image2',{attrs:{\"src\":item.url},on:{\"load\":function (e,file){ return _vm.handLoadImg(e,file,item); },\"delete\":function($event){_vm.handDeleteImage(item,$index)}}})]})],2)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0ea29dc7\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/post/edit.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0ea29dc7\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./edit.vue\")\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0ea29dc7\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=1!./edit.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./edit.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0ea29dc7\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./edit.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0ea29dc7\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/post/edit.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}