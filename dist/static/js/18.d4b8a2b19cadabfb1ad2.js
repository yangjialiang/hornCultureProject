webpackJsonp([18],{V3T7:function(t,e){},kTWP:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o("Dd8w"),a=o.n(r),n=o("NYxO"),c=o("m8LM"),i=o("vhNw"),s={name:"",components:{FileImage2:c.a,CropperBox:i.a},props:{},data:function(){return{cropper:{dialog:!1,src:""},detail:{}}},watch:{},computed:a()({},Object(n.c)({userType:function(t){return t.userInfo.userType},cover:function(t){return t.write.article.cover}})),created:function(){this.init()},methods:{init:function(){var t=this;this.$route.query.productId?this.$http.get(this.$port.ARTICLE_PROT,{params:{productId:this.$route.query.productId}}).then(function(e){200===e.code?t.$store.commit(t.$actionType.set_article_data,{contType:t.$route.query.contType,productId:t.$route.query.productId,cover:e.data.preimg,title:e.data.title,desc:e.data.desc,content:e.data.cont}):alert(e.msg)}):this.$store.commit(this.$actionType.set_article_data,{productId:0,contType:1,cover:"",clubId:-1,title:"",desc:"",content:""})},initData:function(){},handDeleteImage:function(){this.$store.commit(this.$actionType.set_article_data,{cover:""})},handLoadFile:function(t,e){var o=this;console.log(t,e),this.cropper.dialog=!0,setTimeout(function(){o.cropper.src=t.target.result},100)},handCropperDone:function(t){var e=this;t.getCroppedCanvas({width:350,height:350}).toBlob(function(t){var o=new FormData;o.append("imgType",1),o.append("upload",t),e.$http.post(e.$port.UPLOAD_IMG,o).then(function(t){var o;200===t.code?(e.$store.commit(e.$actionType.set_article_data,{cover:t.data,contType:(o=parseInt(e.$route.query.contType),isNaN(o)&&(o=1),o)}),e.cropper.dialog=!1):alert(t.msg)})})},handNext:function(){this.cover?4===this.userType?this.$router.push({path:"/write/club"}):this.$router.push({path:"edit",query:this.$route.query}):alert("请上传图片")}}},p={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("section",[o("mt-header",{attrs:{title:"上传封面"}},[o("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[o("mt-button",{attrs:{icon:"back"},on:{click:function(e){t.$router.go(-1)}}})],1),t._v(" "),o("mt-button",{attrs:{slot:"right"},on:{click:t.handNext},slot:"right"},[t._v("下一步")])],1),t._v(" "),o("section",{staticClass:"upload"},[t.cover?[o("h3",{staticClass:"fw4"},[t._v("上传成功")])]:[o("h3",{staticClass:"fw4"},[t._v("上传封面")])],t._v(" "),o("file-image2",{attrs:{src:t.cover},on:{load:t.handLoadFile,delete:t.handDeleteImage}}),t._v(" "),o("p",[t._v("注：该封面图片会出现在“约”的文章列表及文章头部")])],2),t._v(" "),t.cropper.dialog?[o("cropper-box",{attrs:{src:t.cropper.src},on:{cancel:function(e){t.cropper.dialog=!1},done:t.handCropperDone}})]:t._e()],2)},staticRenderFns:[]};var u=o("VU/8")(s,p,!1,function(t){o("rmWV"),o("V3T7")},"data-v-0a0d10d2",null);e.default=u.exports},rmWV:function(t,e){}});
//# sourceMappingURL=18.d4b8a2b19cadabfb1ad2.js.map