webpackJsonp([15],{S7Fr:function(t,n){},j16s:function(t,n){},oOw3:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("//Fk"),i=e.n(o),r=e("Dd8w"),a=e.n(r),s=e("NYxO"),u=e("TrLn"),c=e("m8LM"),l={name:"",components:{FixedLayout:u.a,FileImage2:c.a},props:{},data:function(){return{myPreimg:[],myContent:""}},watch:{},computed:a()({},Object(s.c)({tagId:function(t){return t.write.post.tagId},clubId:function(t){return t.write.post.clubId},content:function(t){return t.write.post.myContent}})),created:function(){this.init()},mounted:function(){},methods:{init:function(){this.myPreimg.push({url:"",base64:"",file:null})},initData:function(){},handNext:function(){var t=this;this.$store.commit(this.$actionType.set_post_data,{content:this.myContent,preimg:this.myPreimg});var n,e={clubId:this.clubId,tagId:this.tagId,cont:this.myContent,preimg:(n="",t.myPreimg.forEach(function(t){return t.url&&(n+=t.url+"#")}),n)};this.$http.post(this.$port.POST_DISCUSS,this.$qs.stringify(e)).then(function(n){alert(n.msg),200===n.code&&t.$router.push({path:"/forumPage"})})},uploadImg:function(t){var n=this;return new i.a(function(e,o){var i=new FormData;i.append("imgType",1),i.append("upload",t),n.$http.post(n.$port.UPLOAD_IMG,i).then(function(t){e(t)})})},handLoadImg:function(t,n,e){var o=this;e.base64=t.target.result,e.file=n,this.uploadImg(n).then(function(t){200===t.code?(e.url=t.data,o.myPreimg.push({base64:"",file:null,url:""})):alert(t.msg)})},handDeleteImage:function(t,n){this.myPreimg.splice(n,1)}}},m={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("section",{staticStyle:{background:"#fff"}},[e("mt-header",{attrs:{title:"发帖"}},[e("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[e("mt-button",{attrs:{icon:"back"},on:{click:function(n){t.$router.go(-1)}}})],1),t._v(" "),e("mt-button",{attrs:{slot:"right"},on:{click:t.handNext},slot:"right"},[t._v("发送")])],1),t._v(" "),e("mt-field",{attrs:{placeholder:"请输入帖子内容",type:"textarea",rows:"4"},model:{value:t.myContent,callback:function(n){t.myContent=n},expression:"myContent"}}),t._v(" "),e("section",{staticClass:"m-uploads"},[t._l(t.myPreimg,function(n,o){return[e("file-image2",{attrs:{src:n.base64},on:{load:function(e,o){return t.handLoadImg(e,o,n)},delete:function(e){t.handDeleteImage(n,o)}}})]})],2)],1)},staticRenderFns:[]};var d=e("VU/8")(l,m,!1,function(t){e("j16s"),e("S7Fr")},"data-v-40dea10b",null);n.default=d.exports}});
//# sourceMappingURL=15.28d227c7844c76fd9e1b.js.map