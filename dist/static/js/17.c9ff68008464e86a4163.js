webpackJsonp([17],{"2gLg":function(t,n){},NwJe:function(t,n){},oOw3:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("//Fk"),i=e.n(o),r=e("Dd8w"),a=e.n(r),c=e("NYxO"),u=e("TrLn"),s=e("m8LM"),l=e("VDWi"),d={name:"",components:{FixedLayout:u.a,FileImage2:s.a},props:{},data:function(){return{myPreimg:[],myContent:""}},watch:{},computed:a()({},Object(c.c)({tagId:function(t){return t.write.post.tagId},clubId:function(t){return t.write.post.clubId},content:function(t){return t.write.post.myContent}})),created:function(){this.init()},mounted:function(){},methods:{init:function(){for(var t=0;t<3;t++)this.myPreimg.push({url:"",file:null})},initData:function(){},handNext:function(){var t=this;this.$store.commit(this.$actionType.set_post_data,{content:this.myContent,preimg:this.myPreimg});var n,e={clubId:this.clubId,tagId:this.tagId,cont:this.myContent,preimg:(n="",t.myPreimg.forEach(function(t){return t.url&&(n+=t.url+"#")}),n)};this.$http.post(this.$port.POST_DISCUSS,this.$qs.stringify(e)).then(function(n){200!==n.code?alert("发帖失败"):t.$router.push({path:"/forumPage"})})},uploadImg:function(t){var n=this;return new i.a(function(e,o){new l.a(t,{quality:.8,maxWidth:750,convertSize:2e6,success:function(t){var o=new FormData;o.append("imgType",1),o.append("upload",t,t.name),n.$http.post(n.$port.UPLOAD_IMG,o).then(function(t){e(t)}).catch(function(t){alert("图片上传失败")})},error:function(t){o(t)}})})},handLoadImg:function(t,n,e){e.file=n,this.uploadImg(n).then(function(t){200===t.code?e.url=t.data:alert("图片上传失败")}).catch(function(){alert("图片压缩失败")})},handDeleteImage:function(t,n){t.file="",t.url=""}}},f={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("section",{staticStyle:{background:"#fff"}},[e("mt-header",{attrs:{title:"发帖"}},[e("router-link",{attrs:{slot:"left",to:"/"},slot:"left"},[e("mt-button",{attrs:{icon:"back"},on:{click:function(n){t.$router.go(-1)}}})],1),t._v(" "),e("mt-button",{attrs:{slot:"right"},on:{click:t.handNext},slot:"right"},[t._v("发送")])],1),t._v(" "),e("mt-field",{attrs:{placeholder:"请输入帖子内容",type:"textarea",rows:"4"},model:{value:t.myContent,callback:function(n){t.myContent=n},expression:"myContent"}}),t._v(" "),e("section",{staticClass:"m-uploads"},[t._l(t.myPreimg,function(n,o){return[e("file-image2",{attrs:{src:n.url},on:{load:function(e,o){return t.handLoadImg(e,o,n)},delete:function(e){t.handDeleteImage(n,o)}}})]})],2)],1)},staticRenderFns:[]};var m=e("VU/8")(d,f,!1,function(t){e("NwJe"),e("2gLg")},"data-v-0ea29dc7",null);n.default=m.exports}});
//# sourceMappingURL=17.c9ff68008464e86a4163.js.map