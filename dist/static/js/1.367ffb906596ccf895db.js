webpackJsonp([1],{"eQ+r":function(t,e){},"q/rC":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Gu7T"),n=o.n(s),i=o("Dd8w"),a=o.n(i),m=o("Au9i"),d=o("Cz8s"),c=o("mpiD"),r=o("wE2M"),l=o("NYxO"),u=o("owcu"),p={name:"",props:["sendComment","needUpdate"],components:{"v-Header":d.a,"v-forumList":c.a,"v-commentpage":r.default,"v-loadmove":u.a},data:function(){return{discussId:this.$route.params.discussId,forumLists:[],addCommentVisible:!1,sendCommentId:0,sendCommentatUserId:0,loadType:"more",loading:!0,lastCommentId:0}},computed:a()({},Object(l.c)({_userid:function(t){return t.userInfo.userId}})),watch:{needUpdate:function(){this.initPage()}},methods:{loadMore:function(){this.getComment()},getComment:function(){var t=this;"all"==this.loadType||this.loading||(this.loading=!0,this.$http.get(this.$port.COMMENT_LIST_PROT,{params:{contId:this.discussId,lastCommentId:this.lastCommentId}}).then(function(e){var o=e.data;t.loading=!1,200==e.code&&(t.forumLists[0].commentList=[].concat(n()(t.forumLists[0].commentList),n()(o)),o.length>0?(t.lastCommentId=o.pop().commentId,t.loadType="more"):t.loadType="all")}).catch(function(e){t.loading=!1,console.log(e.response.data)}))},Comment:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;e==this._userid?this.sendComment(t,e,o):(this.sendCommentId=t,this.sendCommentatUserId=e,this.addCommentVisible=!0)},initPage:function(){this.getDiscussList(),this.$emit("update-comment-list")},getDiscussList:function(){var t=this;this.$http.get(this.$port.DISCUSS_DETAILS_PROT+"?discussId="+this.discussId,{}).then(function(e){var o=e.data;200==e.code&&(t.forumLists=[o],console.log(o.commentList),o.commentList.length<30?(t.loadType="all",t.loading=!0):t.loading=!1,o.commentList.length>0?t.lastCommentId=[].concat(n()(o.commentList)).pop().commentId:(t.loadType="all",t.loading=!0),console.log(t.forumLists))}).catch(function(t){console.log(t.response.data)})},removePost:function(t){var e=this;event.stopPropagation(),Object(m.MessageBox)({title:"",message:"确定删除吗?",showCancelButton:!0,confirmButtonText:"删除"}).then(function(o){"confirm"===o&&(m.Indicator.open({text:"正在删除..."}),e.$http.post(e.$port.DISCUSS_DEL_PROT+"?discussId="+t,{}).then(function(t){t.data;200==t.code&&(m.Indicator.close(),e.$emit("update-comment-list"),e.$router.go(-1))}).catch(function(t){console.log(t.response.data)}))})},Back:function(){this.addCommentVisible=!1}},created:function(){this.getDiscussList()}},f={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("transition",{attrs:{name:"fade",mode:"in-out"}},[o("div",{staticClass:"forumDetailsPage"},[o("v-Header",{staticClass:"head"},[o("span",{attrs:{slot:"text"},slot:"text"},[t._v("社区详情")])]),t._v(" "),o("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],attrs:{id:"forumDetailsScroll","infinite-scroll-disabled":"loading","infinite-scroll-distance":"10"}},[o("div",[o("v-forumList",{attrs:{forumLists:t.forumLists,removePost:t.removePost,sendComment:t.Comment,isforumPage:!1}}),t._v(" "),t.forumLists.length>0&&t.forumLists[0].commentList.length>0?o("v-loadmove",{staticStyle:{"margin-top":"-0.3rem"},attrs:{type:t.loadType}}):t._e()],1)]),t._v(" "),o("mt-popup",{staticClass:"addCommentpopup",attrs:{modal:!1,position:"right"},model:{value:t.addCommentVisible,callback:function(e){t.addCommentVisible=e},expression:"addCommentVisible"}},[o("v-commentpage",{attrs:{isforumPage:!0,articleId:t.sendCommentId,atUserId:t.sendCommentatUserId,comeBack:t.Back},on:{"update-comment-list":t.initPage}})],1)],1)])},staticRenderFns:[]};var h=o("VU/8")(p,f,!1,function(t){o("eQ+r")},"data-v-8c4079c4",null);e.default=h.exports}});
//# sourceMappingURL=1.367ffb906596ccf895db.js.map